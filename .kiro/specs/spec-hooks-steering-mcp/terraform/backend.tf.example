# Example Terraform Backend Configuration
# 
# This file shows how to configure remote state storage using AWS S3 and DynamoDB.
# Rename this file to backend.tf and update the values before using.
#
# Benefits of remote state:
# - Team collaboration with state locking
# - State file encryption at rest
# - State file versioning
# - Prevents accidental state file loss

terraform {
  backend "s3" {
    # S3 bucket for storing Terraform state
    bucket = "my-terraform-state-bucket"
    
    # Path within the bucket
    key = "tilt-sensor-lab/terraform.tfstate"
    
    # AWS region where the S3 bucket is located
    region = "us-east-1"
    
    # DynamoDB table for state locking
    dynamodb_table = "terraform-state-lock"
    
    # Enable encryption at rest
    encrypt = true
    
    # Optional: Use specific AWS profile
    # profile = "my-aws-profile"
    
    # Optional: Add tags to the state file
    # tags = {
    #   Project     = "KiroDemo"
    #   Environment = "Lab"
    #   ManagedBy   = "Terraform"
    # }
  }
}

# Prerequisites for using this backend:
#
# 1. Create an S3 bucket for state storage:
#    aws s3api create-bucket \
#      --bucket my-terraform-state-bucket \
#      --region us-east-1
#
# 2. Enable versioning on the S3 bucket:
#    aws s3api put-bucket-versioning \
#      --bucket my-terraform-state-bucket \
#      --versioning-configuration Status=Enabled
#
# 3. Enable encryption on the S3 bucket:
#    aws s3api put-bucket-encryption \
#      --bucket my-terraform-state-bucket \
#      --server-side-encryption-configuration '{
#        "Rules": [{
#          "ApplyServerSideEncryptionByDefault": {
#            "SSEAlgorithm": "AES256"
#          }
#        }]
#      }'
#
# 4. Create a DynamoDB table for state locking:
#    aws dynamodb create-table \
#      --table-name terraform-state-lock \
#      --attribute-definitions AttributeName=LockID,AttributeType=S \
#      --key-schema AttributeName=LockID,KeyType=HASH \
#      --billing-mode PAY_PER_REQUEST \
#      --region us-east-1
#
# 5. After creating the backend resources, initialize Terraform:
#    terraform init
#
# 6. Terraform will prompt to migrate existing state to the new backend

# Alternative: Local Backend (default)
# If you don't configure a backend, Terraform uses local state storage.
# The state file will be stored as terraform.tfstate in the current directory.
# This is suitable for individual development but not recommended for teams.
